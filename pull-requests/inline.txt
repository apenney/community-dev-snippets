I've also added some inline comments on things that could use clarification or improvement.

